<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>إدارة محتوى صفحة الهبوط - Supabase</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        min-height: 100vh;
        color: #333;
        direction: rtl;
    }

    .container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 20px;
    }

    /* Header */
    .header {
        background: white;
        border-radius: 15px;
        padding: 2rem;
        margin-bottom: 2rem;
        box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .header h1 {
        color: #ff6b35;
        font-size: 2rem;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .save-btn, .preview-btn {
        background: linear-gradient(45deg, #ff6b35, #f7931e);
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 8px;
        cursor: pointer;
        font-weight: bold;
        transition: all 0.3s ease;
        margin-left: 10px;
        display: flex;
        align-items: center;
        gap: 8px;
    }

.preview-btn {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 10px 18px;
    background: linear-gradient(135deg, #caba0d, #df1010);
    color: #fff;
    text-decoration: none;
    border-radius: 8px;
    font-size: 1rem;
    font-weight: 500;
    transition: all 0.3s ease;
}

.preview-btn:hover {
    background: linear-gradient(135deg, #caba0d, #df1010);
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}


    .save-btn:hover, .preview-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(255, 107, 53, 0.3);
    }

    .preview-btn {
        background: linear-gradient(45deg, #28a745, #20c997);
    }

    /* Connection Status */
    .connection-status {
        padding: 10px;
        border-radius: 8px;
        margin-bottom: 1rem;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .status-connected {
        background: #d4edda;
        color: #155724;
    }

    .status-disconnected {
        background: #f8d7da;
        color: #721c24;
    }

    .status-connecting {
        background: #cce7ff;
        color: #0c5460;
    }

    /* Main Content */
    .main-content {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 2rem;
    }

    /* Editor Panel */
    .editor-panel {
        background: white;
        border-radius: 15px;
        padding: 2rem;
        box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        max-height: calc(100vh - 200px);
        overflow-y: auto;
    }

    .section-title {
        color: #ff6b35;
        font-size: 1.3rem;
        margin-bottom: 1rem;
        padding-bottom: 0.5rem;
        border-bottom: 2px solid #eee;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .form-section {
        margin-bottom: 2rem;
    }

    .form-group {
        margin-bottom: 1rem;
    }

    .form-group label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: bold;
        color: #555;
    }

    .form-group input,
    .form-group textarea,
    .form-group select {
        width: 100%;
        padding: 12px;
        border: 2px solid #eee;
        border-radius: 8px;
        font-size: 14px;
        transition: border-color 0.3s ease;
    }

    .form-group input:focus,
    .form-group textarea:focus,
    .form-group select:focus {
        outline: none;
        border-color: #ff6b35;
        box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.1);
    }

    .form-group textarea {
        resize: vertical;
        min-height: 80px;
    }

    /* Feature Cards Editor */
    .feature-cards-editor {
        border: 2px dashed #ff6b35;
        border-radius: 10px;
        padding: 1rem;
        margin-top: 1rem;
    }

    .feature-card-item {
        background: #fff9f5;
        border-radius: 8px;
        padding: 1rem;
        margin-bottom: 1rem;
        border-left: 4px solid #ff6b35;
        position: relative;
    }

    .feature-card-item .delete-btn {
        position: absolute;
        top: 10px;
        left: 10px;
        background: #dc3545;
        color: white;
        border: none;
        border-radius: 50%;
        width: 25px;
        height: 25px;
        cursor: pointer;
        font-size: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .add-feature-btn {
        background: linear-gradient(45deg, #28a745, #20c997);
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 8px;
        cursor: pointer;
        width: 100%;
        margin-top: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
    }

    /* Statistics Editor */
    .stats-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1rem;
        margin-top: 1rem;
    }

    /* Courses Editor */
    .courses-editor {
        border: 2px dashed #f7931e;
        border-radius: 10px;
        padding: 1rem;
        margin-top: 1rem;
    }

    .course-item {
        background: #fff9f5;
        border-radius: 8px;
        padding: 1rem;
        margin-bottom: 1rem;
        border-left: 4px solid #f7931e;
        position: relative;
    }

    .course-item .delete-course-btn {
        position: absolute;
        top: 10px;
        left: 10px;
        background: #dc3545;
        color: white;
        border: none;
        border-radius: 50%;
        width: 25px;
        height: 25px;
        cursor: pointer;
        font-size: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .add-course-btn {
        background: linear-gradient(45deg, #28a745, #20c997);
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 8px;
        cursor: pointer;
        width: 100%;
        margin-top: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
    }

    /* Testimonials Editor */
    .testimonials-editor {
        border: 2px dashed #ff6b35;
        border-radius: 10px;
        padding: 1rem;
        margin-top: 1rem;
    }

    .testimonial-item {
        background: #fff9f5;
        border-radius: 8px;
        padding: 1rem;
        margin-bottom: 1rem;
        border-left: 4px solid #ff6b35;
        position: relative;
    }

    .testimonial-item .delete-testimonial-btn {
        position: absolute;
        top: 10px;
        left: 10px;
        background: #dc3545;
        color: white;
        border: none;
        border-radius: 50%;
        width: 25px;
        height: 25px;
        cursor: pointer;
        font-size: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .add-testimonial-btn {
        background: linear-gradient(45deg, #28a745, #20c997);
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 8px;
        cursor: pointer;
        width: 100%;
        margin-top: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
    }

    /* Preview Panel */
    .preview-panel {
        background: white;
        border-radius: 15px;
        padding: 0;
        box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        overflow: hidden;
        max-height: calc(100vh - 200px);
        overflow-y: auto;
    }

    .preview-header {
        background: linear-gradient(135deg, #ff6b35, #f7931e);
        color: white;
        padding: 1rem;
        text-align: center;
    }

    .preview-content {
        padding: 2rem;
    }

    /* Preview Styles */
    .preview-hero {
        text-align: center;
        margin-bottom: 2rem;
        background: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%);
        color: white;
        padding: 2rem;
        border-radius: 15px;
    }

    .preview-hero h1 {
        font-size: 2rem;
        margin-bottom: 1rem;
    }

    .preview-hero p {
        margin-bottom: 1.5rem;
        opacity: 0.9;
    }

    .preview-cta {
        background: linear-gradient(45deg, #ffffff, #f0f0f0);
        color: #ff6b35;
        padding: 12px 24px;
        border-radius: 50px;
        text-decoration: none;
        font-weight: bold;
        display: inline-block;
        transition: all 0.3s ease;
        border: none;
        cursor: pointer;
    }

    .preview-cta:hover {
        transform: translateY(-3px);
        box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        background: linear-gradient(45deg, #ffffff, #e0e0e0);
    }

    .preview-features {
        margin-bottom: 2rem;
    }

    .preview-features h2 {
        text-align: center;
        margin-bottom: 1rem;
        color: #ff6b35;
    }

    .preview-features-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1.5rem;
    }

    .preview-feature-item {
        background: #fff9f5;
        padding: 1.5rem;
        border-radius: 10px;
        border-left: 4px solid #ff6b35;
        box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        transition: all 0.3s ease;
    }

    .preview-feature-item:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(0,0,0,0.1);
    }

    .preview-feature-icon {
        font-size: 2rem;
        color: #ff6b35;
        margin-bottom: 1rem;
    }

    .preview-feature-item h3 {
        color: #333;
        margin-bottom: 0.5rem;
    }

    .preview-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
        margin-bottom: 2rem;
    }

    .preview-stat {
        text-align: center;
        background: #fff9f5;
        padding: 1.5rem;
        border-radius: 10px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        border: 1px solid #ff6b35;
    }

    .preview-stat-number {
        font-size: 2rem;
        font-weight: bold;
        color: #ff6b35;
        display: block;
        margin-bottom: 0.5rem;
    }

    .preview-stat-label {
        color: #666;
        font-size: 0.9rem;
    }

    .preview-courses {
        margin-bottom: 2rem;
    }

    .preview-courses h2 {
        text-align: center;
        margin-bottom: 1rem;
        color: #ff6b35;
    }

    .preview-courses-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 2rem;
        margin-top: 3rem;
    }

    .preview-course-card {
        background: #fff9f5;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        transition: all 0.3s ease;
        border: 1px solid #f7931e;
    }

    .preview-course-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 15px 30px rgba(0,0,0,0.15);
    }

    .preview-course-image {
        height: 200px;
        background: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 3rem;
    }

    .preview-course-content {
        padding: 1.5rem;
    }

    .preview-course-content h3 {
        font-size: 1.3rem;
        margin-bottom: 0.5rem;
        color: #333;
    }

    .preview-course-content p {
        color: #666;
        margin-bottom: 1rem;
        font-size: 0.95rem;
    }

    .preview-course-meta {
        display: flex;
        justify-content: space-between;
        color: #777;
        font-size: 0.9rem;
        margin-bottom: 1rem;
    }

    .preview-course-price {
        font-weight: bold;
        color: #ff6b35;
        font-size: 1.2rem;
    }

    .preview-testimonials {
        margin-bottom: 2rem;
    }

    .preview-testimonials h2 {
        text-align: center;
        margin-bottom: 1rem;
        color: #ff6b35;
    }

    .preview-testimonials-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 2rem;
        margin-top: 3rem;
    }

    .preview-testimonial-card {
        background: white;
        padding: 2rem;
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        position: relative;
        transition: all 0.3s ease;
        border: 1px solid #ff6b35;
    }

    .preview-testimonial-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 40px rgba(0,0,0,0.15);
    }

    .preview-testimonial-card::before {
        content: '"';
        font-size: 4rem;
        color: #ff6b35;
        position: absolute;
        top: 10px;
        right: 20px;
        opacity: 0.3;
    }

    .preview-testimonial-text {
        font-style: italic;
        margin-bottom: 1rem;
        color: #666;
        line-height: 1.6;
    }

    .preview-testimonial-author {
        font-weight: bold;
        color: #333;
        display: flex;
        align-items: center;
    }

    .preview-author-avatar {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%);
        margin-left: 15px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
    }

    .preview-testimonial-role {
        color: #ff6b35;
        font-size: 0.9rem;
    }

    .preview-contact {
        background: #fff9f5;
        padding: 2rem;
        border-radius: 15px;
        margin-top: 2rem;
        border: 1px solid #ff6b35;
    }

    .preview-contact h2 {
        color: #ff6b35;
        text-align: center;
        margin-bottom: 1.5rem;
    }

    .preview-contact-info {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1.5rem;
    }

    .preview-contact-item {
        display: flex;
        align-items: flex-start;
        gap: 1rem;
    }

    .preview-contact-icon {
        background: linear-gradient(135deg, #ff6b35, #f7931e);
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        flex-shrink: 0;
    }

    /* Loading Animation */
    .loading {
        display: none;
        text-align: center;
        padding: 2rem;
    }

    .spinner {
        display: inline-block;
        width: 40px;
        height: 40px;
        border: 4px solid #f3f3f3;
        border-top: 4px solid #ff6b35;
        border-radius: 50%;
        animation: spin 1s linear infinite;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    /* Success Message */
    .success-message {
        background: #d4edda;
        color: #155724;
        padding: 1rem;
        border-radius: 8px;
        margin-bottom: 1rem;
        display: none;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .error-message {
        background: #f8d7da;
        color: #721c24;
        padding: 1rem;
        border-radius: 8px;
        margin-bottom: 1rem;
        display: none;
        display: flex;
        align-items: center;
        gap: 10px;
        display: none;
    }

    /* Mobile Responsive */
    @media (max-width: 992px) {
        .main-content {
            grid-template-columns: 1fr;
        }
        
        .header {
            flex-direction: column;
            gap: 1rem;
            text-align: center;
        }
        
        .stats-grid {
            grid-template-columns: 1fr;
        }
        
        .preview-features-grid,
        .preview-courses-grid,
        .preview-testimonials-grid {
            grid-template-columns: 1fr;
        }
    }

    @media (max-width: 576px) {
        .container {
            padding: 10px;
        }
        
        .header, .editor-panel, .preview-panel {
            padding: 1rem;
        }
        
        .preview-stats {
            grid-template-columns: 1fr 1fr;
        }
    }
</style></head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1><i class="fas fa-edit"></i> إدارة محتوى صفحة الهبوط</h1>
            <div>
                <button class="preview-btn" onclick="updatePreview()">
                    <i class="fas fa-eye"></i> معاينة
                </button>
   <a href="./landing-page.html" target="_blank" class="preview-btn">
    <i class="fas fa-globe"></i> الذهاب إلى الموقع الرئيسي
</a>

                <button class="save-btn" onclick="saveContent()">
                    <i class="fas fa-save"></i> حفظ التغييرات
                </button>
            </div>
        </div>

        <!-- Connection Status -->
        <div class="connection-status status-connecting" id="connectionStatus">
            <i class="fas fa-spinner fa-spin"></i> جاري الاتصال بقاعدة البيانات...
        </div>

        <!-- Success/Error Messages -->
        <div class="success-message" id="successMessage">
            <i class="fas fa-check-circle"></i> تم حفظ التغييرات بنجاح!
        </div>
        <div class="error-message" id="errorMessage">
            <i class="fas fa-exclamation-triangle"></i> حدث خطأ أثناء الحفظ. يرجى المحاولة مرة أخرى.
        </div>

        <!-- Loading -->
        <div class="loading" id="loadingIndicator">
            <div class="spinner"></div>
            <p>جاري تحميل البيانات...</p>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Editor Panel -->
            <div class="editor-panel">
                <!-- Hero Section -->
                <div class="form-section">
                    <h3 class="section-title">
                        <i class="fas fa-home"></i>
                        القسم الرئيسي
                    </h3>
                    <div class="form-group">
                        <label>العنوان الرئيسي</label>
                        <input type="text" id="heroTitle" value="مستقبل التعلم يبدأ هنا">
                    </div>
                    <div class="form-group">
                        <label>الوصف</label>
                        <textarea id="heroDescription">منصة تعليمية متطورة تقدم أفضل المحتوى التعليمي بأحدث التقنيات والأساليب التفاعلية</textarea>
                    </div>
                    <div class="form-group">
                        <label>نص زر الدعوة للعمل</label>
                        <input type="text" id="heroButtonText" value="ابدأ رحلتك التعليمية الآن">
                    </div>
                </div>

                <!-- Features Section -->
                <div class="form-section">
                    <h3 class="section-title">
                        <i class="fas fa-star"></i>
                        قسم المميزات
                    </h3>
                    <div class="form-group">
                        <label>عنوان القسم</label>
                        <input type="text" id="featuresTitle" value="لماذا أكاديمية المستقبل؟">
                    </div>
                    <div class="feature-cards-editor" id="featureCardsContainer">
                        <!-- Feature cards will be populated here -->
                    </div>
                    <button class="add-feature-btn" onclick="addFeatureCard()">
                        <i class="fas fa-plus"></i> إضافة ميزة جديدة
                    </button>
                </div>

                <!-- Statistics Section -->
                <div class="form-section">
                    <h3 class="section-title">
                        <i class="fas fa-chart-bar"></i>
                        قسم الإحصائيات
                    </h3>
                    <div class="stats-grid">
                        <div class="form-group">
                            <label>عدد الطلاب</label>
                            <input type="number" id="studentsCount" value="50000">
                        </div>
                        <div class="form-group">
                            <label>عدد الدورات</label>
                            <input type="number" id="coursesCount" value="200">
                        </div>
                        <div class="form-group">
                            <label>عدد المدربين</label>
                            <input type="number" id="trainersCount" value="100">
                        </div>
                        <div class="form-group">
                            <label>نسبة الرضا (%)</label>
                            <input type="number" id="satisfactionRate" value="95" max="100">
                        </div>
                    </div>
                </div>

                <!-- Courses Section -->
                <div class="form-section">
                    <h3 class="section-title">
                        <i class="fas fa-graduation-cap"></i>
                        قسم الدورات التدريبية
                    </h3>
                    <div class="form-group">
                        <label>عنوان القسم</label>
                        <input type="text" id="coursesTitle" value="الدورات التدريبية">
                    </div>
                    <div class="courses-editor" id="coursesContainer">
                        <!-- Courses will be populated here -->
                    </div>
                    <button class="add-course-btn" onclick="addCourse()">
                        <i class="fas fa-plus"></i> إضافة دورة جديدة
                    </button>
                </div>

                <!-- Testimonials Section -->
                <div class="form-section">
                    <h3 class="section-title">
                        <i class="fas fa-comments"></i>
                        قسم آراء الطلاب
                    </h3>
                    <div class="form-group">
                        <label>عنوان القسم</label>
                        <input type="text" id="testimonialsTitle" value="ماذا يقول طلابنا">
                    </div>
                    <div class="testimonials-editor" id="testimonialsContainer">
                        <!-- Testimonials will be populated here -->
                    </div>
                    <button class="add-testimonial-btn" onclick="addTestimonial()">
                        <i class="fas fa-plus"></i> إضافة رأي جديد
                    </button>
                </div>

                <!-- Contact Section -->
                <div class="form-section">
                    <h3 class="section-title">
                        <i class="fas fa-envelope"></i>
                        معلومات التواصل
                    </h3>
                    <div class="form-group">
                        <label>البريد الإلكتروني</label>
                        <input type="email" id="contactEmail" value="info@future-academy.com">
                    </div>
                    <div class="form-group">
                        <label>رقم الهاتف</label>
                        <input type="text" id="contactPhone" value="+966 11 123 4567">
                    </div>
                    <div class="form-group">
                        <label>العنوان</label>
                        <input type="text" id="contactAddress" value="الرياض، المملكة العربية السعودية">
                    </div>
                </div>
            </div>

            <!-- Preview Panel -->
            <div class="preview-panel">
                <div class="preview-header">
                    <h2><i class="fas fa-eye"></i> معاينة مباشرة</h2>
                </div>
                <div class="preview-content" id="previewContent">
                    <!-- Preview content will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Supabase Client -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <script>
        // Supabase Configuration
        const SUPABASE_URL = "https://zefsmckaihzfiqqbdake.supabase.co";
        const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InplZnNtY2thaWh6ZmlxcWJkYWtlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQyMzUzNTgsImV4cCI6MjA2OTgxMTM1OH0.vktk2VkEPtMclb6jb_pFa1DbrqWX9SOZRsBR577o5mc";
        
        let supabase;
        let isConnected = false;

        // Sample data structure for features
        let featuresData = [
            {
                icon: 'fas fa-video',
                title: 'محتوى تفاعلي',
                description: 'فيديوهات عالية الجودة، تمارين تفاعلية، ومحتوى متنوع يناسب جميع أساليب التعلم'
            },
            {
                icon: 'fas fa-users',
                title: 'مجتمع تعليمي',
                description: 'انضم لمجتمع من المتعلمين والخبراء، شارك الخبرات واحصل على الدعم المستمر'
            },
            {
                icon: 'fas fa-certificate',
                title: 'شهادات معتمدة',
                description: 'احصل على شهادات معتمدة دولياً تعزز من فرصك المهنية وتطورك الوظيفي'
            },
            {
                icon: 'fas fa-mobile-alt',
                title: 'التعلم في أي مكان',
                description: 'منصة متجاوبة تعمل على جميع الأجهزة، تعلم في أي وقت ومن أي مكان'
            }
        ];

        // Sample data structure for courses
        let coursesData = [
            {
                icon: 'fas fa-laptop-code',
                title: 'تطوير الويب الحديث',
                description: 'تعلم أساسيات تطوير الويب باستخدام HTML, CSS, JavaScript والتقنيات الحديثة',
                duration: '40 ساعة',
                students: '1200 طالب',
                price: '299 جنيه'
            },
            {
                icon: 'fas fa-paint-brush',
                title: 'التصميم الجرافيكي الاحترافي',
                description: 'احترف أدوات التصميم مثل Photoshop وIllustrator وابدأ مسيرتك الإبداعية',
                duration: '35 ساعة',
                students: '980 طالب',
                price: '249 جنيه'
            },
            {
                icon: 'fas fa-chart-line',
                title: 'التسويق الرقمي',
                description: 'تعلم استراتيجيات التسويق الرقمي وزيادة المبيعات عبر الإنترنت',
                duration: '30 ساعة',
                students: '1500 طالب',
                price: '199 جنيه'
            }
        ];

        // Sample data structure for testimonials
        let testimonialsData = [
            {
                text: 'منصة رائعة غيرت حياتي المهنية بالكامل. المحتوى عالي الجودة والمدربون محترفون جداً.',
                author: 'أحمد محمد',
                role: 'مطور برمجيات',
                avatar: 'أ'
            },
            {
                text: 'أفضل استثمار قمت به في مجال التعليم. الدورات منظمة والمتابعة ممتازة.',
                author: 'سارة أحمد',
                role: 'مصممة جرافيك',
                avatar: 'س'
            },
            {
                text: 'التعلم أصبح أسهل وأكثر متعة. أنصح الجميع بالانضمام لهذه المنصة الرائعة.',
                author: 'محمد علي',
                role: 'رائد أعمال',
                avatar: 'م'
            }
        ];

        // Load Supabase library dynamically with error handling
        function loadSupabaseLibrary() {
            return new Promise((resolve, reject) => {
                // Check if already loaded
                if (typeof window.supabase !== 'undefined' && window.supabase.createClient) {
                    console.log('Supabase library already loaded');
                    resolve();
                    return;
                }
                
                // Create script element
                const script = document.createElement('script');
                script.src = 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2';
                script.async = true;
                
                script.onload = function() {
                    console.log('Supabase library loaded successfully');
                    // Check if loaded correctly
                    if (typeof window.supabase !== 'undefined' && window.supabase.createClient) {
                        resolve();
                    } else {
                        reject(new Error('Supabase library loaded but not accessible'));
                    }
                };
                
                script.onerror = function() {
                    console.error('Failed to load Supabase library');
                    reject(new Error('Failed to load Supabase library from CDN'));
                };
                
                // Add to document
                document.head.appendChild(script);
            });
        }

        // Initialize Supabase client
        async function initializeSupabase() {
            try {
                console.log('Initializing Supabase...');
                
                // Load Supabase library if not already loaded
                await loadSupabaseLibrary();
                
                // Verify supabase object exists
                if (typeof window.supabase === 'undefined') {
                    throw new Error('Supabase object is not available');
                }
                
                if (typeof window.supabase.createClient !== 'function') {
                    throw new Error('Supabase createClient function is not available');
                }
                
                // Initialize Supabase client
                supabase = window.supabase.createClient(SUPABASE_URL.trim(), SUPABASE_ANON_KEY.trim());
                console.log('Supabase client initialized successfully');
                return true;
            } catch (error) {
                console.error('Error initializing Supabase:', error);
                return false;
            }
        }

        // Auto-connect to Supabase on page load
        async function autoConnectToSupabase() {
            document.getElementById('connectionStatus').className = 'connection-status status-connecting';
            document.getElementById('connectionStatus').innerHTML = '<i class="fas fa-spinner fa-spin"></i> جاري الاتصال بقاعدة البيانات...';
            
            try {
                // Initialize Supabase if not already done
                if (!supabase) {
                    const initialized = await initializeSupabase();
                    if (!initialized) {
                        throw new Error('فشل في تهيئة اتصال Supabase');
                    }
                }
                
                // Test connection
                console.log('Testing connection...');
                const { data, error } = await supabase
                    .from('landing_content')
                    .select('id')
                    .limit(1);
                
                if (error) throw error;
                
                isConnected = true;
                document.getElementById('connectionStatus').className = 'connection-status status-connected';
                document.getElementById('connectionStatus').innerHTML = '<i class="fas fa-check-circle"></i> متصل بقاعدة البيانات بنجاح!';
                
                // Load content after successful connection
                await loadContent();
            } catch (error) {
                console.error('Connection error:', error);
                isConnected = false;
                document.getElementById('connectionStatus').className = 'connection-status status-disconnected';
                document.getElementById('connectionStatus').innerHTML = '<i class="fas fa-exclamation-circle"></i> فشل الاتصال بقاعدة البيانات: ' + error.message;
                
                // Show error message
                showError('فشل في الاتصال بقاعدة البيانات: ' + error.message);
            }
        }

        // Load content from Supabase
        async function loadContent() {
            if (!isConnected) {
                console.log('Not connected to database');
                return;
            }
            
            showLoading(true);
            try {
                const { data, error } = await supabase
                    .from('landing_content')
                    .select('*')
                    .eq('id', 1)
                    .single();

                if (error && error.code !== 'PGRST116') {
                    throw error;
                }

                if (data) {
                    populateForm(data.content_data);
                } else {
                    // If no data exists, use default values
                    populateForm(null);
                }
            } catch (error) {
                console.error('Error loading content:', error);
                showError('حدث خطأ في تحميل البيانات: ' + error.message);
            } finally {
                showLoading(false);
                renderFeatureCards();
                renderCourses();
                renderTestimonials();
                updatePreview();
            }
        }

        // Populate form with loaded data
        function populateForm(data) {
            if (!data) {
                // Use default values
                data = {
                    hero: {
                        title: "مستقبل التعلم يبدأ هنا",
                        description: "منصة تعليمية متطورة تقدم أفضل المحتوى التعليمي بأحدث التقنيات والأساليب التفاعلية",
                        buttonText: "ابدأ رحلتك التعليمية الآن"
                    },
                    features: {
                        title: "لماذا أكاديمية المستقبل؟",
                        items: featuresData
                    },
                    stats: {
                        students: 50000,
                        courses: 200,
                        trainers: 100,
                        satisfaction: 95
                    },
                    courses: {
                        title: "الدورات التدريبية",
                        items: coursesData
                    },
                    testimonials: {
                        title: "ماذا يقول طلابنا",
                        items: testimonialsData
                    },
                    contact: {
                        email: "info@future-academy.com",
                        phone: "+966 11 123 4567",
                        address: "الرياض، المملكة العربية السعودية"
                    }
                };
            }

            // Populate Hero Section
            if (data.hero) {
                document.getElementById('heroTitle').value = data.hero.title || '';
                document.getElementById('heroDescription').value = data.hero.description || '';
                document.getElementById('heroButtonText').value = data.hero.buttonText || '';
            }

            // Populate Features Section
            if (data.features) {
                document.getElementById('featuresTitle').value = data.features.title || '';
                if (data.features.items) {
                    featuresData = data.features.items;
                }
            }

            // Populate Stats Section
            if (data.stats) {
                document.getElementById('studentsCount').value = data.stats.students || 0;
                document.getElementById('coursesCount').value = data.stats.courses || 0;
                document.getElementById('trainersCount').value = data.stats.trainers || 0;
                document.getElementById('satisfactionRate').value = data.stats.satisfaction || 0;
            }

            // Populate Courses Section
            if (data.courses) {
                document.getElementById('coursesTitle').value = data.courses.title || 'الدورات التدريبية';
                if (data.courses.items) {
                    coursesData = data.courses.items;
                }
            }

            // Populate Testimonials Section
            if (data.testimonials) {
                document.getElementById('testimonialsTitle').value = data.testimonials.title || 'ماذا يقول طلابنا';
                if (data.testimonials.items) {
                    testimonialsData = data.testimonials.items;
                }
            }

            // Populate Contact Section
            if (data.contact) {
                document.getElementById('contactEmail').value = data.contact.email || '';
                document.getElementById('contactPhone').value = data.contact.phone || '';
                document.getElementById('contactAddress').value = data.contact.address || '';
            }
        }

        // Save content to Supabase
        async function saveContent() {
            if (!isConnected) {
                showError('غير متصل بقاعدة البيانات. يرجى تحديث الصفحة.');
                return;
            }
            
            showLoading(true);
            
            // Collect all content data
            const contentData = {
                hero: {
                    title: document.getElementById('heroTitle').value,
                    description: document.getElementById('heroDescription').value,
                    buttonText: document.getElementById('heroButtonText').value
                },
                features: {
                    title: document.getElementById('featuresTitle').value,
                    items: featuresData
                },
                stats: {
                    students: parseInt(document.getElementById('studentsCount').value) || 0,
                    courses: parseInt(document.getElementById('coursesCount').value) || 0,
                    trainers: parseInt(document.getElementById('trainersCount').value) || 0,
                    satisfaction: parseInt(document.getElementById('satisfactionRate').value) || 0
                },
                courses: {
                    title: document.getElementById('coursesTitle').value,
                    items: coursesData
                },
                testimonials: {
                    title: document.getElementById('testimonialsTitle').value,
                    items: testimonialsData
                },
                contact: {
                    email: document.getElementById('contactEmail').value,
                    phone: document.getElementById('contactPhone').value,
                    address: document.getElementById('contactAddress').value
                }
            };

            try {
                // Use upsert to either update or insert the record
                const { data, error } = await supabase
                    .from('landing_content')
                    .upsert({
                        id: 1,
                        content_data: contentData,
                        updated_at: new Date().toISOString()
                    }, {
                        onConflict: 'id'
                    });

                if (error) throw error;

                showSuccess('تم حفظ التغييرات بنجاح!');
            } catch (error) {
                console.error('Error saving content:', error);
                showError('حدث خطأ أثناء الحفظ: ' + error.message);
            } finally {
                showLoading(false);
            }
        }

        // Render feature cards in editor
        function renderFeatureCards() {
            const container = document.getElementById('featureCardsContainer');
            container.innerHTML = '';

            featuresData.forEach((feature, index) => {
                const cardHTML = `
                    <div class="feature-card-item">
                        <button class="delete-btn" onclick="deleteFeatureCard(${index})" title="حذف">
                            <i class="fas fa-times"></i>
                        </button>
                        <div class="form-group">
                            <label>الأيقونة (Font Awesome class)</label>
                            <select onchange="updateFeatureCard(${index}, 'icon', this.value)">
                                <option value="fas fa-video" ${feature.icon === 'fas fa-video' ? 'selected' : ''}>فيديو</option>
                                <option value="fas fa-users" ${feature.icon === 'fas fa-users' ? 'selected' : ''}>مستخدمون</option>
                                <option value="fas fa-certificate" ${feature.icon === 'fas fa-certificate' ? 'selected' : ''}>شهادة</option>
                                <option value="fas fa-mobile-alt" ${feature.icon === 'fas fa-mobile-alt' ? 'selected' : ''}>هاتف</option>
                                <option value="fas fa-chart-line" ${feature.icon === 'fas fa-chart-line' ? 'selected' : ''}>رسم بياني</option>
                                <option value="fas fa-headset" ${feature.icon === 'fas fa-headset' ? 'selected' : ''}>دعم</option>
                                <option value="fas fa-laptop-code" ${feature.icon === 'fas fa-laptop-code' ? 'selected' : ''}>برمجة</option>
                                <option value="fas fa-paint-brush" ${feature.icon === 'fas fa-paint-brush' ? 'selected' : ''}>تصميم</option>
                                <option value="fas fa-book" ${feature.icon === 'fas fa-book' ? 'selected' : ''}>كتاب</option>
                                <option value="fas fa-graduation-cap" ${feature.icon === 'fas fa-graduation-cap' ? 'selected' : ''}>تخرج</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>العنوان</label>
                            <input type="text" value="${feature.title}" 
                                   onchange="updateFeatureCard(${index}, 'title', this.value)">
                        </div>
                        <div class="form-group">
                            <label>الوصف</label>
                            <textarea onchange="updateFeatureCard(${index}, 'description', this.value)">${feature.description}</textarea>
                        </div>
                    </div>
                `;
                container.innerHTML += cardHTML;
            });
        }

        // Add new feature card
        function addFeatureCard() {
            featuresData.push({
                icon: 'fas fa-star',
                title: 'ميزة جديدة',
                description: 'وصف الميزة الجديدة'
            });
            renderFeatureCards();
            updatePreview();
        }

        // Delete feature card
        function deleteFeatureCard(index) {
            if (confirm('هل أنت متأكد من حذف هذه الميزة؟')) {
                featuresData.splice(index, 1);
                renderFeatureCards();
                updatePreview();
            }
        }

        // Update feature card data
        function updateFeatureCard(index, field, value) {
            featuresData[index][field] = value;
            updatePreview();
        }

        // Render courses in editor
        function renderCourses() {
            const container = document.getElementById('coursesContainer');
            container.innerHTML = '';

            coursesData.forEach((course, index) => {
                const courseHTML = `
                    <div class="course-item">
                        <button class="delete-course-btn" onclick="deleteCourse(${index})" title="حذف">
                            <i class="fas fa-times"></i>
                        </button>
                        <div class="form-group">
                            <label>الأيقونة (Font Awesome class)</label>
                            <select onchange="updateCourse(${index}, 'icon', this.value)">
                                <option value="fas fa-laptop-code" ${course.icon === 'fas fa-laptop-code' ? 'selected' : ''}>برمجة</option>
                                <option value="fas fa-paint-brush" ${course.icon === 'fas fa-paint-brush' ? 'selected' : ''}>تصميم</option>
                                <option value="fas fa-chart-line" ${course.icon === 'fas fa-chart-line' ? 'selected' : ''}>تسويق</option>
                                <option value="fas fa-mobile-alt" ${course.icon === 'fas fa-mobile-alt' ? 'selected' : ''}>موبايل</option>
                                <option value="fas fa-camera" ${course.icon === 'fas fa-camera' ? 'selected' : ''}>تصوير</option>
                                <option value="fas fa-language" ${course.icon === 'fas fa-language' ? 'selected' : ''}>لغات</option>
                                <option value="fas fa-graduation-cap" ${course.icon === 'fas fa-graduation-cap' ? 'selected' : ''}>تخرج</option>
                                <option value="fas fa-book" ${course.icon === 'fas fa-book' ? 'selected' : ''}>كتاب</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>عنوان الدورة</label>
                            <input type="text" value="${course.title}" 
                                   onchange="updateCourse(${index}, 'title', this.value)">
                        </div>
                        <div class="form-group">
                            <label>وصف الدورة</label>
                            <textarea onchange="updateCourse(${index}, 'description', this.value)">${course.description}</textarea>
                        </div>
                        <div class="form-group">
                            <label>مدة الدورة</label>
                            <input type="text" value="${course.duration}" 
                                   onchange="updateCourse(${index}, 'duration', this.value)">
                        </div>
                        <div class="form-group">
                            <label>عدد الطلاب</label>
                            <input type="text" value="${course.students}" 
                                   onchange="updateCourse(${index}, 'students', this.value)">
                        </div>
                        <div class="form-group">
                            <label>السعر</label>
                            <input type="text" value="${course.price}" 
                                   onchange="updateCourse(${index}, 'price', this.value)">
                        </div>
                    </div>
                `;
                container.innerHTML += courseHTML;
            });
        }

        // Add new course
        function addCourse() {
            coursesData.push({
                icon: 'fas fa-graduation-cap',
                title: 'دورة جديدة',
                description: 'وصف الدورة الجديدة',
                duration: 'ساعات',
                students: 'طالب',
                price: 'سعر'
            });
            renderCourses();
            updatePreview();
        }

        // Delete course
        function deleteCourse(index) {
            if (confirm('هل أنت متأكد من حذف هذه الدورة؟')) {
                coursesData.splice(index, 1);
                renderCourses();
                updatePreview();
            }
        }

        // Update course data
        function updateCourse(index, field, value) {
            coursesData[index][field] = value;
            updatePreview();
        }

        // Render testimonials in editor
        function renderTestimonials() {
            const container = document.getElementById('testimonialsContainer');
            container.innerHTML = '';

            testimonialsData.forEach((testimonial, index) => {
                const testimonialHTML = `
                    <div class="testimonial-item">
                        <button class="delete-testimonial-btn" onclick="deleteTestimonial(${index})" title="حذف">
                            <i class="fas fa-times"></i>
                        </button>
                        <div class="form-group">
                            <label>الرأي</label>
                            <textarea onchange="updateTestimonial(${index}, 'text', this.value)">${testimonial.text}</textarea>
                        </div>
                        <div class="form-group">
                            <label>اسم الطالب</label>
                            <input type="text" value="${testimonial.author}" 
                                   onchange="updateTestimonial(${index}, 'author', this.value)">
                        </div>
                        <div class="form-group">
                            <label>الوظيفة</label>
                            <input type="text" value="${testimonial.role}" 
                                   onchange="updateTestimonial(${index}, 'role', this.value)">
                        </div>
                        <div class="form-group">
                            <label>الحرف الأول من الاسم (للصورة الرمزية)</label>
                            <input type="text" value="${testimonial.avatar}" maxlength="1"
                                   onchange="updateTestimonial(${index}, 'avatar', this.value)">
                        </div>
                    </div>
                `;
                container.innerHTML += testimonialHTML;
            });
        }

        // Add new testimonial
        function addTestimonial() {
            testimonialsData.push({
                text: 'رأي الطالب الجديد',
                author: 'اسم الطالب',
                role: 'الوظيفة',
                avatar: 'ط'
            });
            renderTestimonials();
            updatePreview();
        }

        // Delete testimonial
        function deleteTestimonial(index) {
            if (confirm('هل أنت متأكد من حذف هذا الرأي؟')) {
                testimonialsData.splice(index, 1);
                renderTestimonials();
                updatePreview();
            }
        }

        // Update testimonial data
        function updateTestimonial(index, field, value) {
            testimonialsData[index][field] = value;
            updatePreview();
        }

        // Update preview
        function updatePreview() {
            const previewContent = document.getElementById('previewContent');
            
            // Get values from form inputs
            const heroTitle = document.getElementById('heroTitle').value;
            const heroDescription = document.getElementById('heroDescription').value;
            const heroButtonText = document.getElementById('heroButtonText').value;
            const featuresTitle = document.getElementById('featuresTitle').value;
            const coursesTitle = document.getElementById('coursesTitle').value;
            const testimonialsTitle = document.getElementById('testimonialsTitle').value;
            
            const studentsCount = document.getElementById('studentsCount').value;
            const coursesCount = document.getElementById('coursesCount').value;
            const trainersCount = document.getElementById('trainersCount').value;
            const satisfactionRate = document.getElementById('satisfactionRate').value;
            
            const contactEmail = document.getElementById('contactEmail').value;
            const contactPhone = document.getElementById('contactPhone').value;
            const contactAddress = document.getElementById('contactAddress').value;

            // Generate Features HTML
            let featuresHTML = '';
            featuresData.forEach(feature => {
                featuresHTML += `
                    <div class="preview-feature-item">
                        <div class="preview-feature-icon">
                            <i class="${feature.icon}"></i>
                        </div>
                        <h3>${feature.title}</h3>
                        <p>${feature.description}</p>
                    </div>
                `;
            });

            // Generate Courses HTML
            let coursesHTML = '';
            coursesData.forEach(course => {
                coursesHTML += `
                    <div class="preview-course-card">
                        <div class="preview-course-image">
                            <i class="${course.icon}"></i>
                        </div>
                        <div class="preview-course-content">
                            <h3>${course.title}</h3>
                            <p>${course.description}</p>
                            <div class="preview-course-meta">
                                <span><i class="far fa-clock"></i> ${course.duration}</span>
                                <span><i class="fas fa-user-graduate"></i> ${course.students}</span>
                            </div>
                            <div class="preview-course-price">${course.price}</div>
                        </div>
                    </div>
                `;
            });

            // Generate Testimonials HTML
            let testimonialsHTML = '';
            testimonialsData.forEach(testimonial => {
                testimonialsHTML += `
                    <div class="preview-testimonial-card">
                        <p class="preview-testimonial-text">
                            ${testimonial.text}
                        </p>
                        <div class="preview-testimonial-author">
                            <div class="preview-author-avatar">${testimonial.avatar}</div>
                            <div>
                                <div>${testimonial.author}</div>
                                <div class="preview-testimonial-role">${testimonial.role}</div>
                            </div>
                        </div>
                    </div>
                `;
            });

            // Update preview content
            previewContent.innerHTML = `
                <div class="preview-hero">
                    <h1>${heroTitle}</h1>
                    <p>${heroDescription}</p>
                    <a href="#" class="preview-cta">${heroButtonText}</a>
                </div>
                
                <div class="preview-features">
                    <h2>${featuresTitle}</h2>
                    <div class="preview-features-grid">
                        ${featuresHTML}
                    </div>
                </div>
                
                <div class="preview-stats">
                    <div class="preview-stat">
                        <span class="preview-stat-number">${parseInt(studentsCount).toLocaleString()}</span>
                        <span class="preview-stat-label">طالب مسجل</span>
                    </div>
                    <div class="preview-stat">
                        <span class="preview-stat-number">${coursesCount}</span>
                        <span class="preview-stat-label">دورة تدريبية</span>
                    </div>
                    <div class="preview-stat">
                        <span class="preview-stat-number">${trainersCount}</span>
                        <span class="preview-stat-label">مدرب خبير</span>
                    </div>
                    <div class="preview-stat">
                        <span class="preview-stat-number">${satisfactionRate}%</span>
                        <span class="preview-stat-label">نسبة الرضا</span>
                    </div>
                </div>
                
                <div class="preview-courses">
                    <h2>${coursesTitle}</h2>
                    <div class="preview-courses-grid">
                        ${coursesHTML}
                    </div>
                </div>
                
                <div class="preview-testimonials">
                    <h2>${testimonialsTitle}</h2>
                    <div class="preview-testimonials-grid">
                        ${testimonialsHTML}
                    </div>
                </div>
                
                <div class="preview-contact">
                    <h2>تواصل معنا</h2>
                    <div class="preview-contact-info">
                        <div class="preview-contact-item">
                            <div class="preview-contact-icon">
                                <i class="fas fa-envelope"></i>
                            </div>
                            <div>
                                <h4>البريد الإلكتروني</h4>
                                <p>${contactEmail}</p>
                            </div>
                        </div>
                        <div class="preview-contact-item">
                            <div class="preview-contact-icon">
                                <i class="fas fa-phone"></i>
                            </div>
                            <div>
                                <h4>رقم الهاتف</h4>
                                <p>${contactPhone}</p>
                            </div>
                        </div>
                        <div class="preview-contact-item">
                            <div class="preview-contact-icon">
                                <i class="fas fa-map-marker-alt"></i>
                            </div>
                            <div>
                                <h4>العنوان</h4>
                                <p>${contactAddress}</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Utility functions
        function showLoading(show) {
            document.getElementById('loadingIndicator').style.display = show ? 'block' : 'none';
        }

// --- Utility functions ---
function showSuccess(message) {
    const element = document.getElementById('successMessage');
    if (element) {
        element.innerHTML = '<i class="fas fa-check-circle"></i> ' + message;
        element.style.display = 'flex';
        
        // إخفاء الرسالة بعد 3 ثواني
        setTimeout(() => {
            element.style.display = 'none';
        }, 3000);
    }
}

function showError(message) {
    const element = document.getElementById('errorMessage');
    if (element) {
        element.innerHTML = '<i class="fas fa-exclamation-triangle"></i> ' + message;
        element.style.display = 'flex';
        
        // إخفاء الرسالة بعد 3 ثواني
        setTimeout(() => {
            element.style.display = 'none';
        }, 3000);
    }
}        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            // Auto-connect to Supabase
            autoConnectToSupabase();
            
            // Render initial data
            renderFeatureCards();
            renderCourses();
            renderTestimonials();
            
            // Update preview
            updatePreview();
        });

        // Auto-update preview on input changes
        document.addEventListener('input', function(e) {
            if (e.target.closest('.editor-panel')) {
                updatePreview();
            }
        });
    </script>
</body>
</html>